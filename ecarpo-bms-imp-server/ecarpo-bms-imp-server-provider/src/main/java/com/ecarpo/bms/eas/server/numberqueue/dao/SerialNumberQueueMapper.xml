<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecarpo.bms.eas.server.numberqueue.dao.SerialNumberQueueMapper">
  <resultMap id="BaseResultMap" type="com.ecarpo.bms.eas.server.numberqueue.entity.SerialNumberQueueDO">
    <!-- @mbg.generated 2019-07-26 16:48:48 -->
    <result column="`date`" jdbcType="TIMESTAMP" property="date" />
    <result column="store_id" jdbcType="INTEGER" property="storeId" />
    <result column="flag" jdbcType="VARCHAR" property="flag" />
    <result column="number" jdbcType="INTEGER" property="number" />
  </resultMap>
  <insert id="insert" parameterType="com.ecarpo.bms.eas.server.numberqueue.entity.SerialNumberQueueDO">
    <!-- @mbg.generated 2019-07-26 16:48:48 -->
    insert into serial_number_queue (`date`, store_id, flag, 
      number)
    values (#{date,jdbcType=TIMESTAMP}, #{storeId,jdbcType=INTEGER}, #{flag,jdbcType=VARCHAR}, 
      #{number,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.ecarpo.bms.eas.server.numberqueue.entity.SerialNumberQueueDO">
    <!-- @mbg.generated 2019-07-26 16:48:48 -->
    insert into serial_number_queue
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="date != null">
        `date`,
      </if>
      <if test="storeId != null">
        store_id,
      </if>
      <if test="flag != null">
        flag,
      </if>
      <if test="number != null">
        number,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="date != null">
        #{date,jdbcType=TIMESTAMP},
      </if>
      <if test="storeId != null">
        #{storeId,jdbcType=INTEGER},
      </if>
      <if test="flag != null">
        #{flag,jdbcType=VARCHAR},
      </if>
      <if test="number != null">
        #{number,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
    
  <!-- user define -->
  
  <update id="insertReplaceNumber">
    insert replace info dms_repair_workhour
      set number = IFNULL(number, 0) + 1
    where `date` = #{date,jdbcType=TIMESTAMP},
      and storeId = #{storeId,jdbcType=INTEGER},
      and flag = #{flag,jdbcType=VARCHAR}
  </update>
  
  <select id="selectNumberByParams">
    select number
    from dms_repair_workhour
    where `date` = #{date,jdbcType=TIMESTAMP},
      and storeId = #{storeId,jdbcType=INTEGER},
      and flag = #{flag,jdbcType=VARCHAR}
  </select>
  
</mapper>